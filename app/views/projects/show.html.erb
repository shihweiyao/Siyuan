  <div class="row" style="margin-bottom: 20px;">
  	<h3 class="col-md-offset-1 col-sm-5 top-title"><%= @project.name %><span class="top-title-span">計畫</span></h3>
  </div>
<div class="container-fluid">
	<div class="row">	
		<div class="col-md-offset-9">
			<%= link_to "編輯", edit_project_path(@project, :pj_kind => @project.kind), data: { no_turbolink: true }, class: 'btn btn-default edit-btn' %>
			<%= link_to '刪除', @project, method: :delete, data: { confirm: 'Are you sure?' } , class: 'btn btn-danger delete-btn'%>
		</div>
	</div>
</div>
<div class="container-fluid">
	<div class="row">
		<div class="col-md-offset-2 col-md-3 ">
			<div id="doughnutChart_revenue" class="chart" style="position: relative;"></div>
		</div>
		<div class="col-md-2 col-md-offset-1 show-title">簡稱</div>
	    <div class="col-md-4 show-content" style="font-size: 24px;"> <%= @project.abbreviation %></div>
		<div class="col-md-2 col-md-offset-1 show-title">描述</div>
	    <div class="col-md-3 show-content">&nbsp&nbsp<%= @project.description %></div>
	    <div class="col-md-2 col-md-offset-1 show-title">西元年度</div>
	  	<div class="col-md-3 show-content" style="font-size: 24px;"> <%= @project.year.strftime("%Y") %></div>
		<div class="col-md-2 col-md-offset-1 show-title">預算</div>
		<div class="col-md-3 show-content" style="font-size: 24px;"> <%= @project.budget%> 元</div>
		<div class="col-md-2 col-md-offset-1 show-title">收入</div>
	    <div class="col-md-3 show-content" style="font-size: 24px;"> <%= @project.income%> 元</div>
	    <div class="col-md-2 col-md-offset-1 show-title">餘額</div>
	    <div class="col-md-3 show-content" style="font-size: 24px;"> <%= @project.balance%> 元</div>
	</div>
	<div class="row">		
		<div class="col-md-offset-1 col-md-10" style="margin-top: 40px;">
			<div style="border-top: 1px solid #fff;"></div>
		</div>					
	</div>
	<div class="row">
	  <div class="col-md-3 col-md-offset-2 show-title">執行狀況描述</div>
	  <div class="col-md-4 show-content"> <%= @project.exe_desc  %></div>
	</div>
	<div class="row" >
	  <div class="col-md-3 col-md-offset-2 show-title">附件</div>
	  <div class="col-md-4 show-content"> <% unless @project.pj_attachment_file_name.blank? %><%= link_to @project.pj_attachment_file_name, @project.pj_attachment.url(:original, false) %><% end %></div>
	</div>
	<% if @project.kind == GLOBAL_VAR['project_delegate']%>
	<div class="row">
	  <div class="col-md-3 col-md-offset-2 show-title">帳號開始時間</div>
	  <div class="col-md-4"> <%= @project.account_begin.strftime("%Y-%m-%d") %></div>
	</div>
	<div class="row">
	  <div class="col-md-3 col-md-offset-2 show-title">帳號結束時間</div>
	  <div class="col-md-4"> <%= @project.account_end.strftime("%Y-%m-%d") %></div>
	</div>
	<div class="row">
	  <div class="col-md-3 col-md-offset-2 show-title">捐款</div>
	</div>
	<% end %>
	<div class="row" style="margin: 20px 0px;">
  		<h3 class="col-md-offset-1 col-sm-5 top-title">捐款<span class="top-title-span">明細</span></h3>
  	</div>
	<div class="container">
		<% @project.donations.each do |donation| %>
			<%= render "sub_donation_table", donation: donation %>
		<% end %>
	</div>
</div>

<script>
  build_revenue_chart(check_empty(<%= @project.budget %>), check_empty(<%= @project.income %>), check_empty(<%= @project.balance %>))
 function build_revenue_chart(budget, income, balance){
 	
 	$("#doughnutChart_revenue").drawDoughnutChart([
 		{ title: "收入", value: income,   color: "#c070a3" },
	    { title: "餘額", value: balance,  color: "#02a0eb" },
	  ]);
 }
 function check_empty(number){
 	if (number===undefined)
		return 0; 	
 	else
 		return number;
 }
   
</script>


