<div class="container-fluid">
	<div class="row text-center">
		<div class="col-lg-12 text-center">		
		<div class="donation_summary">
			<div class="donation_summary_inner">
				<span class="donation_summary_number">28,888,321</span><span class="donation_summary_en">NTW</span>	
			</div>
			<div class="donation_range text-right">累積期間 2016/01/01~2016/04/13</div>	
		</div>
		</div>
	</div>		
</div>	
<div class="grid">
  <%=render "donation_card" %>	
 
</div>
<a href="#login_form" id="login_btn" class="fancybox btn btn-primary btn-block grid-item-button">委辦計畫</a>		

<div style="display:none">
	<%= form_tag("", method: "post", id: "login_form") do %>
	    	<p id="login_error">請輸入帳號密碼</p>
		<div class="form-group row">
			<label class="col-sm-4 control-label">臨時帳號</label>
			<div class="col-sm-4"><input type="text" id="login_name" name="login_name" size="30" />
		</div>
		</div>
		<div class="form-group row">
			<label class="col-sm-4 control-label">臨時密碼</label>
			<div class="col-sm-4"><input type="password" id="login_pass" name="login_pass" size="30" />
		</div>
		</div>
		<div class="pull-right">
			<input type="submit" value="Login"  class= "btn btn-default"/>
		</div>
	<% end %>
</div>

<script>
// external js: masonry.pkgd.js

var $grid = $('.grid').masonry({
  columnWidth: '.grid-item',
  itemSelector: '.grid-item',
  percentPosition: true
  //gutter: '.gutter-sizer',    
});
/*
$grid.on( 'click', '.grid-item-content', function( event ) {
  $( event.currentTarget ).parent('.grid-item').toggleClass('is-expanded');
  $grid.masonry();
});
*/
$grid.on( 'click', '.grid-item-button', function( event ) {
  $( event.currentTarget ).closest('.grid-item').toggleClass('is-expanded');
  $grid.masonry();
});

$grid.on( 'click', '.grid-item-close', function( event ) {
  $( event.currentTarget ).closest('.grid-item').toggleClass('is-expanded');
  $grid.masonry();
});

//fancybox for login project
$(document).ready(function() {
$("#login_btn").fancybox({
	'scrolling'		: 'no',
	'titleShow'		: false,
	'beforeShow'		: function() {
	    $("#login_error").hide();
	}
});

$("#login_form").bind("submit", function() {

	if ($("#login_name").val().length < 1 || $("#login_pass").val().length < 1) {
	    $("#login_error").show();
	    $.fancybox.update();
	    return false;
	}
	$.fancybox.showLoading();

	$.ajax({
		type		: "POST",
		cache	: false,
		url		: "/projects/check_login",
		data		: $(this).serializeArray(),
		dataType: 'json',
		success: function(data) {
			if (data.success) {
      			window.location.href = data.location;
    		}else{
    			window.location.href = data.location;
    			$.fancybox.hideLoading();
    		}
		}
	});

	return false;
});
}); // ready
</script>
